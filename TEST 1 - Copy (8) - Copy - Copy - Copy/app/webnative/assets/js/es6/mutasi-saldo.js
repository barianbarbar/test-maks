const mainInput=document.querySelector("#main-input"),noContent=document.querySelector("#no-content"),mainContent=document.querySelector("#main-content"),wrapperContent=document.querySelector("#wrapper-content"),labelMonth=document.querySelector("#label-month"),labelUangMasuk=document.querySelector("#label-uang-masuk"),labelUangKeluar=document.querySelector("#label-uang-keluar"),rangeDate=document.querySelector("#range-date"),btnNext=document.querySelector("#btn-next"),btnPrevious=document.querySelector("#btn-previous"),leftArrow=document.querySelector("#icon_panah_b"),rightArrow=document.querySelector("#icon_panah_a"),backgroundLeftArrow=leftArrow.querySelector("#Rectangle_423"),backgroundRightArrow=rightArrow.querySelector("#Rectangle_1287"),strokeLeftArrow=leftArrow.querySelector("#Path_619"),strokeRightArrow=rightArrow.querySelector("#Path_619"),date=new Date;let selectedMonth=0,selectedYear=date.getFullYear(),transactionData,defaultStyle={defaultHeight:"",wrapperHeight:"",wrapperMargin:""},sendData={tanggal:"",tipe:""};const months=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],formatRupiah=(b,f)=>{var g,c=(b="string"==typeof b?b:b.toString()).replace(/[^,\d]/g,"").toString().split(","),d=c[0].length%3,a=c[0].substr(0,d),e=c[0].substr(d).match(/\d{3}/gi);return e&&(a+=(d?".":"")+e.join(".")),"string"==typeof b?0>parseInt(b)&&(a="-"+a):b<0&&(a="-"+a),a=void 0!=c[1]?a+","+c[1]:a,void 0==f?a:a?"Rp "+a:""},injectData=a=>{try{Android.log("response_kiriman"+a)}catch(b){Android.log(b)}transactionData=JSON.parse(a),setupContent()},getData=b=>{try{let c=JSON.stringify(sendData.tipe);Android.log("getData"+c)}catch(f){}let a;if("masuk"===sendData.tipe){try{a=Android.getData("masuk",b.tanggal.toString())}catch(d){Android.log(d)}Android.log(a)}else{try{a=Android.getData("keluar",b.tanggal.toString())}catch(e){Android.log(e)}Android.log(a)}try{Android.log("wwwq"+a)}catch(g){}console.log(a),transactionData=JSON.parse(a),setupContent()},postData=a=>{getData(a)},setSendData=()=>{let a=selectedMonth+1;sendData.tanggal=`${selectedYear}-${1===a.toString().length?"0"+(selectedMonth+1):selectedMonth+1}-1`,console.log(sendData),postData(sendData)},onClickPrevious=()=>{backgroundRightArrow.setAttribute("fill","#2b3252"),strokeRightArrow.setAttribute("fill","#fff"),--selectedMonth<0&&(selectedMonth=11,selectedYear--),setSendData()},onClickNext=()=>{if(date.getMonth()-1===selectedMonth&&date.getFullYear()===selectedYear&&(backgroundRightArrow.setAttribute("fill","#dedede"),strokeRightArrow.setAttribute("fill","#777")),date.getMonth()===selectedMonth&&date.getFullYear()===selectedYear){if(document.querySelector(".alert"))return;let b=`
    <div class="alert alert-danger alert-dismissible fade show mb-2 border-radius-8" role="alert">
      Yaah, bulan setelah ini belum berjalan. ðŸ˜¥
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" onclick="onCloseAlert()"></button>
    </div>
    `;labelMonth.parentElement.insertAdjacentHTML("beforebegin",b);let a=mainInput.offsetHeight;wrapperContent.style.height=`calc(100vh - ${a+4}px)`,wrapperContent.parentElement.parentElement.style.marginTop=`${a+4}px`;return}++selectedMonth>11&&(selectedMonth=0,selectedYear++),setSendData()},onClickUangMasuk=a=>{setupActive(a),"masuk"!==sendData.tipe&&(sendData.tipe="masuk",setSendData())},onClickUangKeluar=a=>{setupActive(a),"keluar"!==sendData.tipe&&(sendData.tipe="keluar",setSendData())},onCloseAlert=()=>{setTimeout(()=>{setupWrapperContentStyle()},100)},isMenuActive=a=>{try{Android.log("isMenuActive"+a),sendData.tipe=a,setupActiveOnFirstRender(),setSendData()}catch(b){}},setupActiveOnFirstRender=()=>{let a=document.querySelectorAll(".menu");"masuk"===sendData.tipe?(a[0].classList.add("border-orange"),a[1].classList.remove("border-orange")):(a[0].classList.remove("border-orange"),a[1].classList.add("border-orange"))},setupActive=a=>{let b=document.querySelectorAll(".menu");b.forEach(a=>{a.classList.contains("border-orange")&&a.classList.remove("border-orange")}),a.classList.add("border-orange")},setupWrapperContentStyle=()=>{defaultStyle.wrapperHeight=`calc(100vh - ${defaultStyle.defaultHeight+4}px)`,defaultStyle.wrapperMargin=`${defaultStyle.defaultHeight+4}px`,wrapperContent.style.height=defaultStyle.wrapperHeight,wrapperContent.parentElement.parentElement.style.marginTop=defaultStyle.wrapperMargin,wrapperContent.parentElement.parentElement.style.transition="all 0.3s ease-in-out"},setupContent=()=>{let b="",a=document.querySelector("#content");if(200===transactionData.status){let{total_uang_masuk:c,total_uang_keluar:d,detail:e}=transactionData.response.data;a.innerHTML="",labelMonth.innerHTML=months[selectedMonth];let f=new Date(selectedYear,selectedMonth,1),g=new Date(selectedYear,selectedMonth+1,0);rangeDate.innerHTML=`${f.getDate()} - ${g.getDate()} ${months[selectedMonth]} ${selectedYear}`,labelUangMasuk.innerHTML=formatRupiah(c.toString(),"Rp "),labelUangKeluar.innerHTML=formatRupiah(d.toString(),"Rp "),mainContent.classList.remove("d-none"),noContent.classList.add("d-none");let h=mainInput.offsetHeight;defaultStyle.defaultHeight=h,setupWrapperContentStyle(),e.map(a=>{b+=`
      <div>
        <h6 class="font-large">${a.title}</h6>
        <div class="d-flex justify-content-between">
          <span class="font-medium">${a.sub_title}</span>
          <span class="${"masuk"===sendData.tipe?"text-success":"text-danger"} font-medium">${"masuk"===sendData.tipe?"+ ":""} ${formatRupiah(a.mutasi.toString())}</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="font-medium">${a.tanggal}</span>
          <span class="font-medium">${formatRupiah(a.saldo_akhir)}</span>
        </div>
        <hr class="my-2" />
    </div>
      `}),a.innerHTML=b}else{labelMonth.innerHTML=months[selectedMonth];let i=new Date(selectedYear,selectedMonth,1),j=new Date(selectedYear,selectedMonth+1,0);labelUangMasuk.innerHTML=formatRupiah(0,"Rp "),labelUangKeluar.innerHTML=formatRupiah(0,"Rp "),rangeDate.innerHTML=`${i.getDate()} - ${j.getDate()} ${months[selectedMonth]} ${selectedYear}`,mainContent.classList.add("d-none"),noContent.classList.remove("d-none")}},setupTotalFirst=()=>{let a=date.getMonth();selectedMonth=a,backgroundRightArrow.setAttribute("fill","#dedede"),strokeRightArrow.setAttribute("fill","#777"),backgroundLeftArrow.setAttribute("fill","#2b3252"),strokeLeftArrow.setAttribute("fill","#fff")};window.onload=()=>{setupTotalFirst()}